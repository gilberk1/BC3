<!doctype html>
<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
	<script type="text/javascript" src="jso-master/dist/jso.js"></script>
	<script>
		var token = new URL("https://gilberk1.github.io/BC3/success.html#access_token=BAhbB0kiAcJ7ImNsaWVudF9pZCI6ImM2MzUxYmYxZWMzMmY5MzAxMGIxZDM4Y2VlYWVhNmUxMzhkOGU3ZDIiLCJleHBpcmVzX2F0IjoiMjAxOC0wNi0yN1QwMjoyMjozNloiLCJ1c2VyX2lkcyI6WzMzODcxODQ2LDMzODk2MjExLDMzODk2NjYzXSwidmVyc2lvbiI6MSwiYXBpX2RlYWRib2x0IjoiNjRkOTU2YjZkNmVmMDE3ZGI5ZGQ4NGVlZjBlNjBiZWYifQY6BkVUSXU6CVRpbWUNYpcdwOfOTFoJOg1uYW5vX251bWkCvAI6DW5hbm9fZGVuaQY6DXN1Ym1pY3JvIgZwOgl6b25lSSIIVVRDBjsARg%3D%3D--2ee482cfddfbdbde5e8da1387b9b67e21a5c9b1b&expires_in=1209600").hash.split('&').filter(function(el) {
			if(el.match('access_token') !== null)
				return true;
		})[0].split('=')[1];

		// $.ajax({
  //        type:"GET",
  //        url:"https://3.basecamp.com/3823897/projects.json",
  //        dataType:"json",
  //        contentType: "application/json; charset=utf-8",
  //        headers: {
  //        	"Authorization": "Bearer " + token
  //        },
  //        success: function (data) {
		// 	$("#data").html("Data:" + data);
		//  }
  //       });

  		function jsonp(url) {
        	let script = document.createElement('script')
        	const name = "_jsonp_" + Math.round(100000 * Math.random());
        	//url formatting
        	if (url.match(/\?/))
        		url += "&callback="+name
        	else
        		url += "?callback="+name

        	console.log(script);
        	
        	script.src = url;

        	console.log(script);

        	window[name] = function(data) {
 	           document.body.removeChild(script);
    	       delete window[name];
        	}
        	console.log(script);
        	document.body.appendChild(script);
		}
		var data = jsonp("https://3.basecamp.com/3823897/projects.json");
		data.then((res) => {
    		console.log(res);
		});

	</script>
</head>
<body>
<p id = "data"></p>
</body>
</html>